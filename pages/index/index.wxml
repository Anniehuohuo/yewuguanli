<!--index.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header">
    <view class="header-bg"></view>
    <view class="header-content">
      <view class="user-section">
        <view class="avatar">
          <open-data type="userAvatarUrl"></open-data>
        </view>
        <view class="user-info">
          <view class="greeting">æ‚¨å¥½ï¼ŒåŸå…‰å­¦é™¢æ¬¢è¿æ‚¨</view>
          <view class="user-name">
            <open-data type="userNickName"></open-data>
          </view>
        </view>
      </view>
      <view class="date-section">
        <view class="date">{{currentDate}}</view>
        <view class="week">{{currentWeek}}</view>
      </view>
    </view>
  </view>
  
  <!-- æ•°æ®æ¦‚è§ˆ -->
  <view class="stats-section">
    <view class="stats-header">
      <text class="stats-title">ğŸ“Š ä»Šæ—¥æ¦‚è§ˆ</text>
    </view>
    <view class="stats-grid">
      <view class="stat-card" bindtap="navigateToCustomers">
        <view class="stat-icon customer-icon">ğŸ‘¥</view>
        <view class="stat-value">{{todayStats.customers}}</view>
        <view class="stat-label">æ–°å¢å®¢æˆ·</view>
      </view>
      <view class="stat-card" bindtap="viewTodayVisits">
        <view class="stat-icon visit-icon">ğŸ“</view>
        <view class="stat-value">{{todayStats.visits}}</view>
        <view class="stat-label">æ‹œè®¿è®°å½•</view>
      </view>
      <view class="stat-card" bindtap="navigateToCheckins">
        <view class="stat-icon checkin-icon">ğŸ“</view>
        <view class="stat-value">{{todayStats.checkins}}</view>
        <view class="stat-label">æ‰“å¡æ¬¡æ•°</view>
      </view>
      <view class="stat-card" bindtap="navigateToStatistics">
        <view class="stat-icon photo-icon">ğŸ“·</view>
        <view class="stat-value">{{todayStats.photos}}</view>
        <view class="stat-label">æ‹ç…§æ•°é‡</view>
      </view>
    </view>
  </view>
  
  <!-- å¿«æ·åŠŸèƒ½ -->
  <view class="quick-actions">
    <view class="section-title">âš¡ å¿«æ·åŠŸèƒ½</view>
    <view class="action-grid">
      <view class="action-item" bindtap="navigateToAddCustomer">
        <view class="action-icon add-customer">ğŸ‘¤</view>
        <view class="action-label">æ–°å¢å®¢æˆ·</view>
      </view>
      <view class="action-item" bindtap="navigateToNearbyCustomers">
        <view class="action-icon nearby">ğŸ“</view>
        <view class="action-label">é™„è¿‘å®¢æˆ·</view>
      </view>
      <view class="action-item" bindtap="navigateToVisitPlan">
        <view class="action-icon visit">ğŸ“…</view>
        <view class="action-label">æ‹œè®¿è®¡åˆ’</view>
      </view>
      <view class="action-item" bindtap="navigateToStatistics">
        <view class="action-icon statistics">ğŸ“Š</view>
        <view class="action-label">æ•°æ®ç»Ÿè®¡</view>
      </view>
    </view>
  </view>
  
  <!-- æœ€è¿‘æ´»åŠ¨ -->
  <view class="recent-section">
    <!-- æœ€è¿‘æ‹œè®¿ -->
    <view class="recent-card">
      <view class="recent-header">
        <view class="recent-title">
          <text class="title-icon">ğŸ“</text>
          <text class="title-text">æœ€è¿‘æ‹œè®¿</text>
        </view>
        <text class="view-more" bindtap="navigateToVisits">æŸ¥çœ‹æ›´å¤š â€º</text>
      </view>
      <view class="recent-content">
        <block wx:if="{{recentVisits.length > 0}}">
          <view class="recent-item" wx:for="{{recentVisits}}" wx:key="id" bindtap="viewVisitDetail" data-id="{{item.id}}">
            <view class="item-avatar">ğŸ“</view>
            <view class="item-info">
              <view class="item-title">{{item.customerName}}</view>
              <view class="item-desc">{{item.visitTime}}</view>
            </view>
            <view class="item-arrow">â€º</view>
          </view>
        </block>
        <view wx:else class="empty-hint">
          <text class="empty-icon">ğŸ“</text>
          <text class="empty-text">æš‚æ— æ‹œè®¿è®°å½•</text>
        </view>
      </view>
    </view>

    <!-- æœ€è¿‘å®¢æˆ· -->
    <view class="recent-card">
      <view class="recent-header">
        <view class="recent-title">
          <text class="title-icon">ğŸ‘¥</text>
          <text class="title-text">æœ€è¿‘å®¢æˆ·</text>
        </view>
        <text class="view-more" bindtap="navigateToCustomers">æŸ¥çœ‹æ›´å¤š â€º</text>
      </view>
      <view class="recent-content">
        <block wx:if="{{recentCustomers.length > 0}}">
          <view class="recent-item" wx:for="{{recentCustomers}}" wx:key="id" bindtap="viewCustomerDetail" data-id="{{item.id}}">
            <view class="item-avatar customer-avatar">{{item.name.charAt(0)}}</view>
            <view class="item-info">
              <view class="item-title">{{item.name}}</view>
              <view class="item-desc">{{item.address}}</view>
            </view>
            <view class="item-arrow">â€º</view>
          </view>
        </block>
        <view wx:else class="empty-hint">
          <text class="empty-icon">ğŸ‘¥</text>
          <text class="empty-text">æš‚æ— å®¢æˆ·ä¿¡æ¯</text>
        </view>
      </view>
    </view>
  </view>
</view>
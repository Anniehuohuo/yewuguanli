<!--pages/business/manage/manage.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-wrapper">
      <input class="search-input" placeholder="æœç´¢å•†å®¶åç§°ã€ç±»åˆ«æˆ–åœ°å€" value="{{searchKeyword}}" bindinput="onSearchInput" bindconfirm="performSearch" />
      <view class="search-btn" bindtap="performSearch">
        <text class="search-icon">ğŸ”</text>
      </view>
    </view>
  </view>

  <!-- æ·»åŠ å•†å®¶æŒ‰é’® -->
  <view class="add-button" bindtap="showAddModal">
    <text class="add-icon">+</text>
    <text>æ·»åŠ å•†å®¶</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- å•†å®¶åˆ—è¡¨ -->
  <view wx:else class="business-list">
    <view wx:if="{{businesses.length === 0}}" class="empty-state">
      <text>æš‚æ— å•†å®¶æ•°æ®</text>
    </view>
    
    <view wx:else>
      <view class="business-item" wx:for="{{businesses}}" wx:key="id">
        <view class="business-info" bindtap="viewBusiness" data-id="{{item.id}}">
          <view class="business-header">
            <text class="business-name">{{item.name}}</text>
            <view class="business-status {{item.status}}">
              <text>{{item.status === 'active' ? 'è¥ä¸šä¸­' : 'å·²åœä¸š'}}</text>
            </view>
          </view>
          
          <view class="business-details">
            <text class="business-category">{{item.category}}</text>
            <text class="business-rating">è¯„åˆ†: {{item.rating}}</text>
          </view>
          
          <view class="business-contact">
            <text class="business-address">{{item.address}}</text>
            <text class="business-phone">{{item.phone}}</text>
          </view>
        </view>
        
        <view class="business-actions">
          <view class="action-btn edit-btn" bindtap="editBusiness" data-id="{{item.id}}">
            <text>ç¼–è¾‘</text>
          </view>
          <view class="action-btn status-btn" bindtap="toggleBusinessStatus" data-id="{{item.id}}">
            <text>{{item.status === 'active' ? 'åœä¸š' : 'è¥ä¸š'}}</text>
          </view>
          <view class="action-btn delete-btn" bindtap="deleteBusiness" data-id="{{item.id}}" data-name="{{item.name}}">
            <text>åˆ é™¤</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æ·»åŠ å•†å®¶æ¨¡æ€æ¡† -->
  <view wx:if="{{showAddModal}}" class="modal-overlay" bindtap="hideAddModal">
    <view class="modal-content" catchtap="">
      <view class="modal-header">
        <text class="modal-title">æ·»åŠ æ–°å•†å®¶</text>
        <view class="modal-close" bindtap="hideAddModal">
          <text>Ã—</text>
        </view>
      </view>
      
      <view class="modal-body">
        <view class="form-group">
          <text class="form-label">å•†å®¶åç§° *</text>
          <input class="form-input" placeholder="è¯·è¾“å…¥å•†å®¶åç§°" value="{{newBusiness.name}}" bindinput="onNewBusinessInput" data-field="name" />
        </view>
        
        <view class="form-group">
          <text class="form-label">å•†å®¶ç±»åˆ« *</text>
          <picker class="form-picker" bindchange="onCategoryChange" value="{{newBusiness.category}}" range="{{categories}}">
            <view class="picker-display">
              <text class="{{newBusiness.category ? '' : 'placeholder'}}">{{newBusiness.category || 'è¯·é€‰æ‹©å•†å®¶ç±»åˆ«'}}</text>
              <text class="picker-arrow">></text>
            </view>
          </picker>
        </view>
        
        <view class="form-group">
          <text class="form-label">è”ç³»ç”µè¯ *</text>
          <input class="form-input" placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯" value="{{newBusiness.phone}}" bindinput="onNewBusinessInput" data-field="phone" />
        </view>
        
        <view class="form-group">
          <text class="form-label">å•†å®¶åœ°å€ *</text>
          <input class="form-input" placeholder="è¯·è¾“å…¥å•†å®¶åœ°å€" value="{{newBusiness.address}}" bindinput="onNewBusinessInput" data-field="address" />
        </view>
        
        <view class="form-group">
          <text class="form-label">å•†å®¶æè¿°</text>
          <textarea class="form-textarea" placeholder="è¯·è¾“å…¥å•†å®¶æè¿°" value="{{newBusiness.description}}" bindinput="onNewBusinessInput" data-field="description"></textarea>
        </view>
      </view>
      
      <view class="modal-footer">
        <view class="modal-btn cancel-btn" bindtap="hideAddModal">
          <text>å–æ¶ˆ</text>
        </view>
        <view class="modal-btn confirm-btn" bindtap="submitNewBusiness">
          <text>ç¡®å®š</text>
        </view>
      </view>
    </view>
  </view>
</view>